<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ¤– Agent Local - Cockpit</title>
    <link rel="stylesheet" href="/style.css">
    <!-- Font Awesome pour les icÃ´nes -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

<div class="dashboard-container">
    
    <!-- 1. TIMELINE (Haut) -->
    <header class="dashboard-header">
        <div class="header-brand">
            <span class="brand-icon">ðŸ¤–</span>
            <div class="brand-info">
                <h1>AGENT LOCAL</h1>
                <small id="session-id">Session: ...</small>
            </div>
        </div>
        
        <!-- La Timeline LinÃ©aire -->
        <div class="timeline-wrapper">
            <div id="timeline-track" class="timeline-track">
                <!-- Les noeuds seront injectÃ©s ici par JS -->
                <!-- Exemple:
                <div class="timeline-node active">
                    <span class="time">10:00:05</span>
                    <span class="icon">ðŸ§ </span>
                    <span class="label">Analyse</span>
                </div>
                -->
            </div>
        </div>

        <div class="header-controls">
            <div id="timer-display" class="timer-display">00:00:00</div>
            <button class="btn-stop-emergency" onclick="stopAgent()" title="ARRÃŠT D'URGENCE">
                <i class="fas fa-power-off"></i> STOP
            </button>
        </div>
    </header>

    <!-- 2. MAIN GRID (Reste de l'Ã©cran) -->
    <div class="dashboard-grid">
        
        <!-- COLONNE GAUCHE : RESSOURCES & RAG -->
        <aside class="panel panel-left">
            <div class="panel-header">
                <h2><i class="fas fa-database"></i> Ressources & RAG</h2>
            </div>
            
            <div class="panel-content">
                <!-- Zone Upload RAG -->
                <div class="drop-zone" id="rag-drop-zone">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Glisser documents pour <strong>RAG</strong></p>
                    <small>ou cliquer pour parcourir</small>
                </div>

                <!-- Structure RAG / Dossiers -->
                <div class="resource-list">
                    <h3><i class="fas fa-folder-open"></i> Explorateur</h3>
                    <ul id="file-explorer" class="file-tree">
                        <li><i class="fas fa-folder"></i> memory/</li>
                        <li><i class="fas fa-folder"></i> backend/</li>
                        <li><i class="fas fa-file-word"></i> rapport_mission.docx</li>
                    </ul>
                </div>

                <!-- Ã‰tat MÃ©moire -->
                <div class="memory-stats">
                    <div class="stat-item">
                        <span class="label">Dataset:</span>
                        <span class="value" id="current-dataset">DÃ©faut</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">Vecteurs:</span>
                        <span class="value">1,240</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- COLONNE CENTRE : COMMUNICATION -->
        <main class="panel panel-center">
            <div class="chat-container">
                <div id="chat-window" class="chat-history">
                    <!-- Messages -->
                </div>
                
                <!-- Zone Upload Context -->
                <div id="context-drop-overlay" class="context-drop-overlay hidden">
                    <i class="fas fa-plus-circle"></i>
                    <p>Ajouter au contexte de la conversation</p>
                </div>

                <div class="chat-input-area">
                    <button id="mic-button" class="btn-icon" onclick="toggleMicrophone()" title="F1: Micro">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <textarea 
                        id="user-message" 
                        placeholder="Instructions pour l'agent..." 
                        rows="1"
                    ></textarea>
                    <button class="btn-send" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </main>

        <!-- COLONNE DROITE : MISSION CONTROL -->
        <aside class="panel panel-right">
            
            <!-- Ã‰tat Actuel -->
            <div class="status-card">
                <h3><i class="fas fa-heartbeat"></i> Statut Agent</h3>
                <div class="status-indicator" id="agent-status-text">
                    <span class="status-dot"></span> En attente
                </div>
                <div class="current-action-detail" id="current-action-detail">
                    Aucune tÃ¢che en cours
                </div>
            </div>

            <!-- Outils Externes -->
            <div class="tools-card">
                <h3><i class="fas fa-tools"></i> Outils</h3>
                <div class="tool-item">
                    <i class="fas fa-globe"></i> Web Search
                    <span class="tool-status inactive">Inactif</span>
                </div>
                <div class="tool-item">
                    <i class="fas fa-file-word"></i> MS Word
                    <span class="tool-status inactive">Inactif</span>
                </div>
                <div class="tool-item">
                    <i class="fas fa-mouse-pointer"></i> ContrÃ´le PC
                    <span class="tool-status active">PrÃªt</span>
                </div>
            </div>

            <!-- Artefacts (Fichiers gÃ©nÃ©rÃ©s) -->
            <div class="artifacts-card">
                <h3><i class="fas fa-magic"></i> Fichiers GÃ©nÃ©rÃ©s</h3>
                <div id="artifacts-list" class="artifacts-list">
                    <div class="empty-state">Aucun fichier gÃ©nÃ©rÃ© rÃ©cemment</div>
                    <!-- Exemple:
                    <div class="artifact-item">
                        <i class="fas fa-file-word"></i>
                        <span>synthese_recherche.docx</span>
                        <button class="btn-mini"><i class="fas fa-external-link-alt"></i></button>
                    </div>
                    -->
                </div>
            </div>

        </aside>
    </div>
</div>

<!-- FLOATING INTERFACE (F2) - ConservÃ©e mais masquÃ©e par dÃ©faut -->
<div id="floating-interface" class="floating-interface hidden">
    <div class="floating-header" id="floating-header">
        <span class="floating-title">ðŸ¤– Agent Local</span>
        <div class="floating-controls">
            <button class="btn-floating-stop" onclick="stopAgent()">ðŸ›‘</button>
            <button class="btn-floating-close" onclick="toggleFloatingInterface()">âœ–</button>
        </div>
    </div>
    <div id="floating-chat-window" class="floating-chat-history"></div>
    <div class="floating-input-container">
        <input id="floating-user-message" type="text" placeholder="Message..." autocomplete="off"/>
        <button class="btn-floating-send" onclick="sendFloatingMessage()">âž¤</button>
    </div>
</div>

<script src="/app.js"></script>
</body>
</html>
